<!DOCTYPE html>
<html lang="fr"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{fragments/_layout}">

<th:block layout:fragment="config">
    <title>Profil</title>
    <link href="/static/css/profil.css" rel="stylesheet"/>
    <link href="/static/css/post.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
</th:block>

<div layout:fragment="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12 col-lg-11">
                <div class="row">
                    <div class="col-lg-12">
                        <img class="baniere" th:src="${user.profil.banner}" alt="Banière">
                    </div>
                </div>
                <div class="row">
                    <div class="d-none d-lg-block col-lg-5 pr-0">
                        <ul class="banner-logo-list banner-left pl-3">
                            <li><a type="button" data-bs-toggle="modal" data-bs-target="#profilModal"><img class="banner-logo" src="/static/css/img/secured-profile.png" alt="Logo profil"></a></li>
                            <li><a href="/profil/show"><img class="banner-logo" src="/static/css/img/map.png" alt="Logo carte"></a></li>
                            <li><a href="#"><img class="banner-logo" src="/static/css/img/friends.png" alt="Logo amis"></a></li>
                        </ul>
                        <div class="modal fade" id="profilModal" tabindex="-1" aria-labelledby="profilModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="profilModalLabel" th:text="${user.username}"></h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <h4 class="text-center mb-3">Coordonnées</h4>
                                        <ul class="modal-list">
                                            <li class="mb-2"><img class="modal-profile-logo" src="/static/css/img/profil.png" alt="Logo profil"><span th:text="${user.firstName} + ' ' + ${user.lastName}"></span></li>
                                            <li class="mb-2"><img class="modal-profile-logo" src="/static/css/img/home.png" alt="Logo adresse"><span th:text="${user.address}"></span></li>
                                            <li class="mb-2"><img class="modal-profile-logo" src="/static/css/img/city.png" alt="Logo adresse"><span th:text="${user.city}"></span></li>
                                            <li class="mb-2"><img class="modal-profile-logo" src="/static/css/img/birthday.png" alt="Logo adresse"><span th:text="${#dates.format(user.birthday,'dd MM yyyy')}"></span></li>
                                            <li class="mb-4"><img class="modal-profile-logo" src="/static/css/img/mail.png" alt="Logo email"><span th:text="${user.email}"></span></li>
                                        </ul>

                                        <h4 th:if="${user.profil}" class="text-center mb-3">Profil</h4>
                                        <ul class="modal-list">
                                            <li th:if="${user.profil.activity}" class="mb-2"><img class="modal-profile-logo" src="/static/css/img/shield.png" alt="Logo profil"><span th:text="${user.profil.activity}"></span></li>
                                            <li th:if="${user.profil.interestedInWoman}" class="mb-2"><img class="modal-profile-logo" src="/static/css/img/love.png" alt="Logo profil"><span>Intéréssé par les femmes</span></li>
                                            <li th:if="${user.profil.interestedInMen}" class="mb-2"><img class="modal-profile-logo" src="/static/css/img/love.png" alt="Logo profil"><span>Intéréssé par les hommes</span></li>
                                            <li th:if="${user.profil.hometown}" class="mb-2"><img class="modal-profile-logo" src="/static/css/img/hometown.png" alt="Logo profil"><span th:text="'De ' + ${user.profil.hometown}"></span></li>
                                            <li th:if="${user.profil.relashionship}"><img class="modal-profile-logo" src="/static/css/img/relationship.png" alt="Logo profil"><span th:text="'En relation avec ' + ${ user.profil.relashionship}"></span></li>
                                        </ul>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 banner-list d-flex justify-content-center">
                        <img class="ornament-logo" src="/static/css/img/ornament.png" alt="Logo circulaire">
                        <img class="profile-logo" th:src="${user.profil.avatar}" alt="Logo de profil">
                        <h1 class="profile-name" th:text="${user.username}"></h1>
                    </div>
                    <div class="col-lg-5 pl-0">
                        <ul class="banner-logo-list banner-right pl-0 pr-3">
                            <li><a href="/picture"><img class="banner-logo" src="/static/css/img/gallery.png" alt="Logo photos"></a></li>
                            <li><a href="/video"><img class="banner-logo" src="/static/css/img/video.png" alt="Logo vidéos"></a></li>
                            <li><a href="/profil/update"><img class="banner-logo" src="/static/css/img/option.png" alt="Logo options"></a></li>
                        </ul>
                    </div>
                </div>
                <div class="row">
                    <!-- PIL : Section Profil -->
                    <div class="col-lg-3 ">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="profile-section">
                                    <ul class="d-flex justify-content-between py-3 px-3 pb-0">
                                        <li class="title-section"><p>Profil</p></li>
                                        <li><a type="button" data-bs-toggle="modal" data-bs-target="#profilModal"><img class="banner-logo" src="/static/css/img/secured-profile.png" alt="Logo profil"></a></li>
                                    </ul>
                                    <ul class="d-flex justify-content-around px-3 align-items-center">
                                        <li><img class="profile-section-logo" th:src="${user.profil.avatar}" alt="Logo de profil"></li>
                                        <li><p class="profile-section-username" th:text="${user.username}"></p></li>
                                    </ul>
                                    <ul class="py-3">
                                        <li th:if="${user.profil.activity}" class="mb-2"><img class="modal-profile-logo" src="/static/css/img/shield.png" alt="Logo profil"><span th:text="${user.profil.activity}"></span></li>
                                        <li class="mb-2"><img class="modal-profile-logo" src="/static/css/img/city.png" alt="Logo adresse"><span th:text="${user.city}"></span></li>
                                        <li th:if="${user.profil.interestedInWoman}" class="mb-2"><img class="modal-profile-logo" src="/static/css/img/love.png" alt="Logo profil"><span>Intéréssé par les femmes</span></li>
                                        <li th:if="${user.profil.interestedInMen}" class="mb-2"><img class="modal-profile-logo" src="/static/css/img/love.png" alt="Logo profil"><span>Intéréssé par les hommes</span></li>
                                        <li th:if="${user.profil.hometown}" class="mb-2"><img class="modal-profile-logo" src="/static/css/img/hometown.png" alt="Logo profil"><span th:text="'De ' + ${user.profil.hometown}"></span></li>
                                        <li th:if="${user.profil.relashionship}" class="mb-3"><img class="modal-profile-logo" src="/static/css/img/relationship.png" alt="Logo profil"><span th:text="'En relation avec ' + ${ user.profil.relashionship}"></span></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- PIL : Section Map -->
                    <div class="col-lg-6 ">
                        <div class="row">
                            <div class="col-lg-12 ">
                                <div class="map-section">
                                    <div id="map"></div>
                                </div>
                            </div>
                        </div>







                        <div class="row">
                            <!--- section post et commentaires -->
                            <div th:switch="${listPosts}">
                                <h2 th:case="null">Pas encore de post!</h2>
                                <div th:case="*">
                                    <h2>Posts</h2>
                                    <a th:href="@{/postCreate}"><i class="fas fa-reply">ajouter un post</i></a>
                                    <div class="row">
                                        <tr th:each="p: ${listPosts}">
                                                <span th:if="${p.isPrivatePost == false}">
                                                    <div id="post-container" name="content">
                                                            <td th:text="${p.content}"></td>
                                                        <div id="by-user">
                                                            <td th:text="${'Le: '+p.createdAt}"></td>
                                                            <td th:text="${'Posté par: '+p.cerebookUser.username}"></td>
                                                        </div>
                                                                    <td><a th:href="@{/addComment/{id}(id=${p.id})}"><i
                                                                            class="far fa-comment"></i>commenter</a></td>
                                                                    <td><a th:href="@{/listComment/{id}(id=${p.id})}"><i
                                                                            class="far fa-comments"></i>voir les commentaires</a></td>
                                                                <form action="#" th:action="@{/update/{id}(id=${p.id})}"
                                                                      method="POST">
                                                                        <button type="submit" value="1" name="like"><i
                                                                                class="far fa-thumbs-up"></i> </button>
                                                                        <button type="submit" value="-1" name="like"><i
                                                                                class="far fa-thumbs-down"></i> </button>
                                                                </form>
                                                        </div>

                                                    <div>

                                                    </div>
                                                </span>
                                        </tr>

                                    </div>
                                </div>
                            </div>
                            <!-- fin section post et commentaires -->
                        </div>










                    </div>










                    <!-- PIL : Section Images -->
                    <div class="col-lg-3">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="picture-section">
                                    <ul class="d-flex justify-content-between py-3 px-3 pb-0">
                                        <li class="title-section"><p>Photos</p></li>
                                        <li><a href="picture/"><img class="banner-logo" src="/static/css/img/gallery.png" alt="Logo Gallery"></a></li>
                                    </ul>
                                    <div class="row pb-3 px-3 justify-content-center">
                                        <div class="trapdoor col-lg-3 my-2 mx-2" th:each="picture : ${pictures}">
                                            <div class="top door pd-2">
                                                <img class="picture-section-img" th:src="${picture.getPicturePath()}">
                                            </div>
                                            <div class="bottom door">
                                                <img class="picture-section-img-bottom" th:src="${picture.getPicturePath()}">
                                            </div>
                                            <div class="picture-button">
                                                <div class="row row-picture-logo">
                                                    <div>
                                                        <a th:href="@{/picture/show(id=${picture.id})}" data-show-count="false" data-size="large" data-dnt="false"><img class="picture-logo d-block col-lg-6 justify-content-between" src="/static/css/img/show.png" alt="Logo Gallery"></a>
                                                    </div>
                                                    <div>
                                                        <a th:href="@{/profil/picture/delete(id=${picture.id})}" data-show-count="false" data-size="large" data-dnt="false"><img class="picture-logo col-lg-6" src="/static/css/img/delete.png" alt="Logo Supprimer"></a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Pil : Section Vidéos -->
                        <div class="row mt-3">
                            <div class="col-lg-12">
                                <div class="video-section">
                                    <ul class="d-flex justify-content-between py-3 px-3 pb-0">
                                        <li class="title-section"><p>Vidéos</p></li>
                                        <li><a href="video/"><img class="banner-logo" src="/static/css/img/video.png" alt="Logo Gallery"></a></li>
                                    </ul>
                                    <div class="row pb-3 px-3 justify-content-center">
                                        <div class="trapdoor col-lg-3 my-2 mx-2" th:each="video : ${videos}">
                                            <div class="top door pd-2">
                                                <video class="video-section-img">
                                                    <source th:src="${video.getVideoPath()}" preload="metadata" #t="0.5">
                                                </video>
                                            </div>
                                            <div class="bottom door">
                                                <video class="video-section-img-bottom">
                                                    <source th:src="${video.getVideoPath()}" preload="metadata" #t="0.5">
                                                </video>
                                            </div>
                                            <div class="video-button">
                                                <div class="row row-video-logo">
                                                    <div>
                                                        <a th:href="@{/video/show(id=${video.id})}" data-show-count="false" data-size="large" data-dnt="false"><img class="video-logo d-block col-lg-6 justify-content-between" src="/static/css/img/show.png" alt="Logo Gallery"></a>
                                                    </div>
                                                    <div>
                                                        <a th:href="@{/profil/video/delete(id=${video.id})}" data-show-count="false" data-size="large" data-dnt="false"><img class="video-logo col-lg-6" src="/static/css/img/delete.png" alt="Logo Supprimer"></a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="d-none d-lg-block col-lg-1 friend-connected">
                <ul>
                    <li><img class="baniere-logo" src="/static/css/img/secured-profile.png"></li>
                    <li><img class="baniere-logo" src="/static/css/img/secured-profile.png"></li>
                    <li><img class="baniere-logo" src="/static/css/img/secured-profile.png"></li>
                    <li><img class="baniere-logo" src="/static/css/img/secured-profile.png"></li>
                    <li><img class="baniere-logo" src="/static/css/img/secured-profile.png"></li>
                </ul>
            </div>
        </div>
    </div>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
    <script th:inline="javascript">
        let cities = L.layerGroup();
        let cartography = [[${cartography}]];
        let user = [[${user}]];
        let allUsers = [[${allUsers}]];

        for (let i = 0; i < allUsers.length; i++) {
            // L.marker([allUsers[i].cartography.y, allUsers[i].cartography.x]).bindPopup('This is Golden, CO.').addTo(cities);

            L.marker([allUsers[i].cartography.y, allUsers[i].cartography.x], {icon: L.icon({
                    className: 'image-icon',
                    iconUrl: allUsers[i].profil.avatar,
                    shadowUrl: '/static/css/img/marker.png',
                    iconSize:     [42, 42], // size of the icon
                    shadowSize:   [42, 60], // size of the shadow
                    iconAnchor:   [15, 44], // point of the icon which will correspond to marker's location
                    shadowAnchor: [15, 44],  // the same for the shadow
                    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
                })}).bindPopup("I am a green leaf.").addTo(cities);

        }

        console.log(allUsers[0].cartography.x);

        var Jawg_Terrain = L.tileLayer('https://{s}.tile.jawg.io/jawg-terrain/{z}/{x}/{y}{r}.png?access-token={accessToken}', {
                attribution: '<a href="http://jawg.io" title="Tiles Courtesy of Jawg Maps" target="_blank">&copy; <b>Jawg</b>Maps</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors', minZoom: 0,
                maxZoom: 22,
                subdomains: 'abcd',
                accessToken: 'LsV1RNeAnn9smXe7sluDMmWb5hnPQAuljgSvaK07bHR2R4oLt3YPUS3E1xYYZaQr'
            }),

            Jawg_Matrix = L.tileLayer('https://{s}.tile.jawg.io/jawg-matrix/{z}/{x}/{y}{r}.png?access-token={accessToken}', {
                attribution: '<a href="http://jawg.io" title="Tiles Courtesy of Jawg Maps" target="_blank">&copy; <b>Jawg</b>Maps</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                minZoom: 0,
                maxZoom: 22,
                subdomains: 'abcd',
                accessToken: 'LsV1RNeAnn9smXe7sluDMmWb5hnPQAuljgSvaK07bHR2R4oLt3YPUS3E1xYYZaQr'
            }),

            USGS_USImageryTopo = L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}', {
                maxZoom: 20,
                attribution: 'Tiles courtesy of the <a href="https://usgs.gov/">U.S. Geological Survey</a>'
            });

        let map = L.map('map', {
            center: [20, 0],
            zoom: 2,
            layers: [Jawg_Terrain, cities]
        });

        var baseLayers = {
            "Street": Jawg_Terrain,
            "Dark" : Jawg_Matrix,
            "Satelitte" : USGS_USImageryTopo,
        };

        var overlays = {
            "Cities": cities
        };

        L.control.layers(baseLayers, overlays).addTo(map);
    </script>
</div>
</html>